<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Mastering React Query in Next.js | Victor De Grandis Site</title>
<meta name="keywords" content="">
<meta name="description" content="React query is a tool for creating hooks for fetching, caching and updating asynchronous data repository.
Motivation Fetching data from your backend is one of the most performance killers features of any frontend, and it really helps to keep a copy of the fetched data in the browser, but it&rsquo;s not always possible, or convenient to build a Redux store, so react-query is a good alternative for managing API results without having to do a lot of work for it, and without having to fetch it again every time you need it.">
<meta name="author" content="">
<link rel="canonical" href="https://victordgrandis.github.io/blog/posts/react-query/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://victordgrandis.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://victordgrandis.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://victordgrandis.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://victordgrandis.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://victordgrandis.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://victordgrandis.github.io/blog/posts/react-query/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-G0JRFKHW77"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-G0JRFKHW77');
        }
      </script>
    
  

<meta property="og:title" content="Mastering React Query in Next.js" />
<meta property="og:description" content="React query is a tool for creating hooks for fetching, caching and updating asynchronous data repository.
Motivation Fetching data from your backend is one of the most performance killers features of any frontend, and it really helps to keep a copy of the fetched data in the browser, but it&rsquo;s not always possible, or convenient to build a Redux store, so react-query is a good alternative for managing API results without having to do a lot of work for it, and without having to fetch it again every time you need it." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://victordgrandis.github.io/blog/posts/react-query/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-20T13:04:27-03:00" />
<meta property="article:modified_time" content="2024-05-20T13:04:27-03:00" /><meta property="og:site_name" content="Victor De Grandis Site" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Mastering React Query in Next.js"/>
<meta name="twitter:description" content="React query is a tool for creating hooks for fetching, caching and updating asynchronous data repository.
Motivation Fetching data from your backend is one of the most performance killers features of any frontend, and it really helps to keep a copy of the fetched data in the browser, but it&rsquo;s not always possible, or convenient to build a Redux store, so react-query is a good alternative for managing API results without having to do a lot of work for it, and without having to fetch it again every time you need it."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://victordgrandis.github.io/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Mastering React Query in Next.js",
      "item": "https://victordgrandis.github.io/blog/posts/react-query/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Mastering React Query in Next.js",
  "name": "Mastering React Query in Next.js",
  "description": "React query is a tool for creating hooks for fetching, caching and updating asynchronous data repository.\nMotivation Fetching data from your backend is one of the most performance killers features of any frontend, and it really helps to keep a copy of the fetched data in the browser, but it\u0026rsquo;s not always possible, or convenient to build a Redux store, so react-query is a good alternative for managing API results without having to do a lot of work for it, and without having to fetch it again every time you need it.",
  "keywords": [
    
  ],
  "articleBody": "React query is a tool for creating hooks for fetching, caching and updating asynchronous data repository.\nMotivation Fetching data from your backend is one of the most performance killers features of any frontend, and it really helps to keep a copy of the fetched data in the browser, but it’s not always possible, or convenient to build a Redux store, so react-query is a good alternative for managing API results without having to do a lot of work for it, and without having to fetch it again every time you need it.\nHere are some benefits of using react-query in your react app:\nSimplified Data Fetching: React Query offers a declarative approach, allowing you to define data dependencies using hooks. This eliminates the boilerplate code typically associated with manual data fetching. Automatic Caching: React Query manages in-memory data caching, reducing unnecessary API calls and improving responsiveness. Optimized Refetching: You can configure refetching behavior based on various scenarios, including window focus or network reconnection, ensuring data freshness. Shared State: React Query facilitates the creation of shared state across components, eliminating the need for complex state management solutions for simple data needs. Improved Developer Experience: React Query’s hooks provide a clean and concise syntax, enhancing code readability and maintainability. Usage First, you have to wrap your application component with the QueryClientProvider, passing an instance of QueryClient. This makes the query client accessible throughout your application.:\n// _app.tsx import { QueryClient, QueryClientProvider } from 'react-query'; export default function App({Component, pageProps}) { const queryClientRef = useRef\u003cQueryClient\u003e(); if (!queryClientRef.current) { queryClientRef.current = new QueryClient(); } return ( \u003cReact.Fragment\u003e \u003cHead\u003e ... \u003c/Head\u003e \u003cQueryClientProvider client={queryClientRef.current}\u003e \u003cComponent {...pageProps} /\u003e \u003c/QueryClientProvider\u003e \u003c/React.Fragment\u003e ); } If you don’t know what a provider is, visit the React docs.\nSecondly, you have to make a service, for example at /lib/api/getClients.ts\n// /lib/api/getClients.ts export async function getClients(): Promise\u003cNetworkResponse\u003cClient\u003e\u003e { return axios.get(`/api/clients`).then(response =\u003e response.data); } And finally, a hook for consuming the service and giving react query the retry options:\n// /lib/hooks/useClients.ts export function useClients() { const { data, status } = useQuery\u003cNetworkResponse\u003cClient\u003e, AxiosError\u003e( `/clients`, () =\u003e getClients(), { retry: true, // Optionally enable retries on failures refetchOnWindowFocus: false, refetchOnReconnect: false } ); return { data: data, status }; } Now you’re good to go, using the hook in every component necessary, like so:\nexport default function Clients() { const { clients } = useClients() return ( \u003c\u003e \u003cdiv className=\"flex flex-wrap mt-4\"\u003e \u003cdiv className=\"w-full mb-12 px-4 h-full\"\u003e {clients \u0026\u0026 clients.length \u003e 0 ? ( \u003cClientsTable clients={clients} /\u003e ) : ( \u003cSpinner /\u003e )} \u003c/div\u003e \u003c/div\u003e \u003c/\u003e ); } Something else to mention if you want to use it, React Query also supports managing state updates through mutations and it’s a very helpful and easy to use way to handle states without adding too much boilerplate.\nConclusion Using react-query is pretty straight forward and simple, and the benefits on performance are considerable, so it’s a very useful tool to have in every React project.\n",
  "wordCount" : "489",
  "inLanguage": "en",
  "datePublished": "2024-05-20T13:04:27-03:00",
  "dateModified": "2024-05-20T13:04:27-03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://victordgrandis.github.io/blog/posts/react-query/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Victor De Grandis Site",
    "logo": {
      "@type": "ImageObject",
      "url": "https://victordgrandis.github.io/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://victordgrandis.github.io/blog/" accesskey="h" title="Victor De Grandis Site (Alt + H)">Victor De Grandis Site</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Mastering React Query in Next.js
    </h1>
    <div class="post-meta"><span title='2024-05-20 13:04:27 -0300 -03'>May 20, 2024</span>

</div>
  </header> 
  <div class="post-content"><p>React query is a tool for creating hooks for fetching, caching and updating asynchronous data <a href="https://github.com/TanStack/query">repository</a>.</p>
<h3 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h3>
<p>Fetching data from your backend is one of the most performance killers features of any frontend, and it really helps to keep a copy of the fetched data in the browser, but it&rsquo;s not always possible, or convenient to build a Redux store, so react-query is a good alternative for managing API results without having to do a lot of work for it, and without having to fetch it again every time you need it.</p>
<p>Here are some benefits of using react-query in your react app:</p>
<ul>
<li>Simplified Data Fetching: React Query offers a declarative approach, allowing you to define data dependencies using hooks. This eliminates the boilerplate code typically associated with manual data fetching.</li>
<li>Automatic Caching: React Query manages in-memory data caching, reducing unnecessary API calls and improving responsiveness.</li>
<li>Optimized Refetching: You can configure refetching behavior based on various scenarios, including window focus or network reconnection, ensuring data freshness.</li>
<li>Shared State: React Query facilitates the creation of shared state across components, eliminating the need for complex state management solutions for simple data needs.</li>
<li>Improved Developer Experience: React Query&rsquo;s hooks provide a clean and concise syntax, enhancing code readability and maintainability.</li>
</ul>
<h3 id="usage">Usage<a hidden class="anchor" aria-hidden="true" href="#usage">#</a></h3>
<p>First, you have to wrap your application component with the <code>QueryClientProvider</code>, passing an instance of <code>QueryClient</code>. This makes the query client accessible throughout your application.:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// _app.tsx
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">QueryClient</span>, <span style="color:#a6e22e">QueryClientProvider</span> } <span style="color:#66d9ef">from</span> <span style="color:#e6db74">&#39;react-query&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">App</span>({<span style="color:#a6e22e">Component</span>, <span style="color:#a6e22e">pageProps</span>}) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">queryClientRef</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">useRef</span>&lt;<span style="color:#f92672">QueryClient</span>&gt;();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span><span style="color:#a6e22e">queryClientRef</span>.<span style="color:#a6e22e">current</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">queryClientRef</span>.<span style="color:#a6e22e">current</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">QueryClient</span>();
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> (
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#f92672">React.Fragment</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">Head</span>&gt;
</span></span><span style="display:flex;"><span>        ...
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">Head</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">QueryClientProvider</span> <span style="color:#a6e22e">client</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">queryClientRef</span>.<span style="color:#a6e22e">current</span>}&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">Component</span> {<span style="color:#a6e22e">...pageProps</span>} /&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">QueryClientProvider</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#f92672">React.Fragment</span>&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If you don&rsquo;t know what a provider is, visit <a href="https://reactjs.org/docs/context.html">the React docs</a>.</p>
<p>Secondly, you have to make a service, for example at <code>/lib/api/getClients.ts</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// /lib/api/getClients.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">async</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">getClients</span>()<span style="color:#f92672">:</span> <span style="color:#a6e22e">Promise</span>&lt;<span style="color:#f92672">NetworkResponse</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">Client</span>&gt;<span style="color:#f92672">&gt;</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">axios</span>.<span style="color:#66d9ef">get</span>(<span style="color:#e6db74">`/api/clients`</span>).<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">response</span> <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">response</span>.<span style="color:#a6e22e">data</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And finally, a hook for consuming the service and giving react query the retry options:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#75715e">// /lib/hooks/useClients.ts
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">useClients() {</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">status</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">useQuery</span>&lt;<span style="color:#f92672">NetworkResponse</span><span style="color:#960050;background-color:#1e0010">&lt;</span><span style="color:#a6e22e">Client</span>&gt;, <span style="color:#a6e22e">AxiosError</span><span style="color:#f92672">&gt;</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">`/clients`</span>,
</span></span><span style="display:flex;"><span>    () <span style="color:#f92672">=&gt;</span> <span style="color:#a6e22e">getClients</span>(),
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">retry</span>: <span style="color:#66d9ef">true</span>, <span style="color:#75715e">// Optionally enable retries on failures
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>      <span style="color:#a6e22e">refetchOnWindowFocus</span>: <span style="color:#66d9ef">false</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">refetchOnReconnect</span>: <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">data</span>: <span style="color:#66d9ef">data</span>, <span style="color:#a6e22e">status</span> };
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now you&rsquo;re good to go, using the hook in every component necessary, like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">Clients() {</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">clients</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">useClients</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> (
</span></span><span style="display:flex;"><span>    &lt;&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;flex flex-wrap mt-4&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#f92672">div</span> <span style="color:#a6e22e">className</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;w-full mb-12 px-4 h-full&#34;</span>&gt;
</span></span><span style="display:flex;"><span>          {<span style="color:#a6e22e">clients</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#a6e22e">clients</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">?</span> (
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">ClientsTable</span> <span style="color:#a6e22e">clients</span><span style="color:#f92672">=</span>{<span style="color:#a6e22e">clients</span>} /&gt;
</span></span><span style="display:flex;"><span>          ) <span style="color:#f92672">:</span> (
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#f92672">Spinner</span> /&gt;
</span></span><span style="display:flex;"><span>          )}
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#f92672">div</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/&gt;
</span></span><span style="display:flex;"><span>  );
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Something else to mention if you want to use it, React Query also supports managing state updates through mutations and it&rsquo;s a very helpful and easy to use way to handle states without adding too much boilerplate.</p>
<h3 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h3>
<p>Using react-query is pretty straight forward and simple, and the benefits on performance are considerable, so it&rsquo;s a very useful tool to have in every React project.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://victordgrandis.github.io/blog/">Victor De Grandis Site</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
