<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>How to use Hotjar JavaScript triggers on Angular | Victor De Grandis Site</title>
<meta name="keywords" content="">
<meta name="description" content="JavaScript triggers are the most useful feature for using Hotjar HeatMaps in one page applications, because without that you can&rsquo;t create HeatMaps on dynamic content or modals, dropdowns, etc. So i will show you how i made it work on an Angular project. I&rsquo;m making the assumption that you already have an Hotjar account and initialize a project.
Include Hotjar in your project First we need to include the tracking code in our index.">
<meta name="author" content="">
<link rel="canonical" href="https://victordgrandis.github.io/blog/posts/hotjar-angular/">
<link crossorigin="anonymous" href="/blog/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://victordgrandis.github.io/blog/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://victordgrandis.github.io/blog/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://victordgrandis.github.io/blog/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://victordgrandis.github.io/blog/apple-touch-icon.png">
<link rel="mask-icon" href="https://victordgrandis.github.io/blog/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://victordgrandis.github.io/blog/posts/hotjar-angular/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
  
    
      <script async src="https://www.googletagmanager.com/gtag/js?id=G-G0JRFKHW77"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-G0JRFKHW77');
        }
      </script>
    
  

<meta property="og:title" content="How to use Hotjar JavaScript triggers on Angular" />
<meta property="og:description" content="JavaScript triggers are the most useful feature for using Hotjar HeatMaps in one page applications, because without that you can&rsquo;t create HeatMaps on dynamic content or modals, dropdowns, etc. So i will show you how i made it work on an Angular project. I&rsquo;m making the assumption that you already have an Hotjar account and initialize a project.
Include Hotjar in your project First we need to include the tracking code in our index." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://victordgrandis.github.io/blog/posts/hotjar-angular/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-19T16:42:23-03:00" />
<meta property="article:modified_time" content="2024-05-19T16:42:23-03:00" /><meta property="og:site_name" content="Victor De Grandis Site" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to use Hotjar JavaScript triggers on Angular"/>
<meta name="twitter:description" content="JavaScript triggers are the most useful feature for using Hotjar HeatMaps in one page applications, because without that you can&rsquo;t create HeatMaps on dynamic content or modals, dropdowns, etc. So i will show you how i made it work on an Angular project. I&rsquo;m making the assumption that you already have an Hotjar account and initialize a project.
Include Hotjar in your project First we need to include the tracking code in our index."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://victordgrandis.github.io/blog/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "How to use Hotjar JavaScript triggers on Angular",
      "item": "https://victordgrandis.github.io/blog/posts/hotjar-angular/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "How to use Hotjar JavaScript triggers on Angular",
  "name": "How to use Hotjar JavaScript triggers on Angular",
  "description": "JavaScript triggers are the most useful feature for using Hotjar HeatMaps in one page applications, because without that you can\u0026rsquo;t create HeatMaps on dynamic content or modals, dropdowns, etc. So i will show you how i made it work on an Angular project. I\u0026rsquo;m making the assumption that you already have an Hotjar account and initialize a project.\nInclude Hotjar in your project First we need to include the tracking code in our index.",
  "keywords": [
    
  ],
  "articleBody": "JavaScript triggers are the most useful feature for using Hotjar HeatMaps in one page applications, because without that you can’t create HeatMaps on dynamic content or modals, dropdowns, etc. So i will show you how i made it work on an Angular project. I’m making the assumption that you already have an Hotjar account and initialize a project.\nInclude Hotjar in your project First we need to include the tracking code in our index.html\n\u003cscript\u003e (function(h,o,t,j,a,r){ h.hj = h.hj || function(){ ( h.hj.q = h.hj.q || []).push(arguments) }; h._hjSettings = { hjid:xxxxxxx, hjsv:x }; a = o.getElementsByTagName('head')[0]; r = o.createElement('script'); r.async = 1; r.src = t + h._hjSettings.hjid + j + h._hjSettings.hjsv; a.appendChild(r); })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv='); \u003c/script\u003e With that we already have the hj function on our window object.\nHotjar Service Now my goal was to make the access to the hj function reliable and mantainable across the Angular aplication, so i made a service:\n@Injectable() export class HotjarService { public getInstance() { return window['hj'] = window['hj'] || this.getHotjarQueue(); } public trigger(eventName: string) { try { this.getInstance()('trigger', eventName); } catch (err) { console.error(err); } } public vpv(url: string) { try { this.getInstance()('vpv', url); } catch (err) { console.error(err); } } private getHotjarQueue() { return function () { (window['hj']['q'] = window['hj']['q'] || []).push(arguments); }; } } Here we have the trigger function that allows us to register a new HeatMap, and the vpv function that register a new virtual page. The getInstance and the getHotjarQueue expose the window.hj if available to the service.\nConclusion Making this little wrapper to the windows.hj we can make the use of Hotjar a lot more readable and mantainable in a big project. Using the function directly from the window object in frameworks as Angular is dangerous because of side effects and untraceable errors.\n",
  "wordCount" : "303",
  "inLanguage": "en",
  "datePublished": "2024-05-19T16:42:23-03:00",
  "dateModified": "2024-05-19T16:42:23-03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://victordgrandis.github.io/blog/posts/hotjar-angular/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Victor De Grandis Site",
    "logo": {
      "@type": "ImageObject",
      "url": "https://victordgrandis.github.io/blog/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://victordgrandis.github.io/blog/" accesskey="h" title="Victor De Grandis Site (Alt + H)">Victor De Grandis Site</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      How to use Hotjar JavaScript triggers on Angular
    </h1>
    <div class="post-meta"><span title='2024-05-19 16:42:23 -0300 -03'>May 19, 2024</span>

</div>
  </header> 
  <div class="post-content"><p>JavaScript triggers are the most useful feature for using Hotjar HeatMaps in one page applications, because without that you can&rsquo;t create HeatMaps on dynamic content or modals, dropdowns, etc.
So i will show you how i made it work on an Angular project.
I&rsquo;m making the assumption that you already have an Hotjar account and initialize a project.</p>
<h2 id="include-hotjar-in-your-project">Include Hotjar in your project<a hidden class="anchor" aria-hidden="true" href="#include-hotjar-in-your-project">#</a></h2>
<p>First we need to include the tracking code in our <code>index.html</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#75715e">&lt;!-- Hotjar Tracking Code for https://yourpage.com/ --&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>   (<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">h</span>,<span style="color:#a6e22e">o</span>,<span style="color:#a6e22e">t</span>,<span style="color:#a6e22e">j</span>,<span style="color:#a6e22e">a</span>,<span style="color:#a6e22e">r</span>){
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">hj</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">hj</span> <span style="color:#f92672">||</span> <span style="color:#66d9ef">function</span>(){ ( <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">hj</span>.<span style="color:#a6e22e">q</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">hj</span>.<span style="color:#a6e22e">q</span> <span style="color:#f92672">||</span> []).<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">arguments</span>) };
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">_hjSettings</span> <span style="color:#f92672">=</span> { <span style="color:#a6e22e">hjid</span><span style="color:#f92672">:</span><span style="color:#a6e22e">xxxxxxx</span>, <span style="color:#a6e22e">hjsv</span><span style="color:#f92672">:</span><span style="color:#a6e22e">x</span> };
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">a</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">getElementsByTagName</span>(<span style="color:#e6db74">&#39;head&#39;</span>)[<span style="color:#ae81ff">0</span>];
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">r</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">o</span>.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;script&#39;</span>); <span style="color:#a6e22e">r</span>.<span style="color:#66d9ef">async</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">t</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">_hjSettings</span>.<span style="color:#a6e22e">hjid</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">j</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">h</span>.<span style="color:#a6e22e">_hjSettings</span>.<span style="color:#a6e22e">hjsv</span>;
</span></span><span style="display:flex;"><span>       <span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">appendChild</span>(<span style="color:#a6e22e">r</span>);
</span></span><span style="display:flex;"><span>   })(window,document,<span style="color:#e6db74">&#39;https://static.hotjar.com/c/hotjar-&#39;</span>,<span style="color:#e6db74">&#39;.js?sv=&#39;</span>);
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><p>With that we already have the hj function on our window object.</p>
<h2 id="hotjar-service">Hotjar Service<a hidden class="anchor" aria-hidden="true" href="#hotjar-service">#</a></h2>
<p>Now my goal was to make the access to the hj function reliable and mantainable across the Angular aplication, so i made a service:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-typescript" data-lang="typescript"><span style="display:flex;"><span><span style="color:#66d9ef">@Injectable</span>()
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">HotjarService</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">getInstance() {</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> window[<span style="color:#e6db74">&#39;hj&#39;</span>] <span style="color:#f92672">=</span> window[<span style="color:#e6db74">&#39;hj&#39;</span>] <span style="color:#f92672">||</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getHotjarQueue</span>(); 
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">trigger</span>(<span style="color:#a6e22e">eventName</span>: <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getInstance</span>()(<span style="color:#e6db74">&#39;trigger&#39;</span>, <span style="color:#a6e22e">eventName</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">public</span> <span style="color:#a6e22e">vpv</span>(<span style="color:#a6e22e">url</span>: <span style="color:#66d9ef">string</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">getInstance</span>()(<span style="color:#e6db74">&#39;vpv&#39;</span>, <span style="color:#a6e22e">url</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">err</span>) {
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">error</span>(<span style="color:#a6e22e">err</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">getHotjarQueue() {</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">function</span> () {
</span></span><span style="display:flex;"><span>      (window[<span style="color:#e6db74">&#39;hj&#39;</span>][<span style="color:#e6db74">&#39;q&#39;</span>] <span style="color:#f92672">=</span> window[<span style="color:#e6db74">&#39;hj&#39;</span>][<span style="color:#e6db74">&#39;q&#39;</span>] <span style="color:#f92672">||</span> []).<span style="color:#a6e22e">push</span>(<span style="color:#a6e22e">arguments</span>);
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Here we have the <code>trigger</code> function that allows us to register a new HeatMap, and the <code>vpv</code> function that register a new virtual page. The <code>getInstance</code> and the <code>getHotjarQueue</code> expose the <code>window.hj</code> if available to the service.</p>
<h2 id="conclusion">Conclusion<a hidden class="anchor" aria-hidden="true" href="#conclusion">#</a></h2>
<p>Making this little wrapper to the <code>windows.hj</code> we can make the use of Hotjar a lot more readable and mantainable in a big project. Using the function directly from the <code>window</code> object in frameworks as Angular is dangerous because of side effects and untraceable errors.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="https://victordgrandis.github.io/blog/">Victor De Grandis Site</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
